\documentclass[a4paper,10pt,twoside]{report}
\usepackage[a4paper]{geometry}
\usepackage{listings}
\usepackage[utf8]{inputenc} % ISO 8859-1
\usepackage[ngerman]{babel}
\usepackage{color}
\usepackage[pdftex]{graphicx}
\usepackage{fancyhdr}
\usepackage{amsmath,amssymb,amsfonts,textcomp}
\usepackage{hyperref}
\usepackage[compact]{titlesec} % Kapitelüberschriften
\usepackage[T1]{fontenc}
\usepackage{xspace}



% Dateipfade
\graphicspath{{pictures/}}

% Eigene Farben
\definecolor{lightgray}{rgb}{0.95,0.95,0.95}
\definecolor{codegray}{rgb}{0.8,0.8,0.8}
\definecolor{darkgray}{rgb}{0.18,0.18,0.18}
\definecolor{mygreen}{rgb}{0.133,0.545,0.133}
\definecolor{mypurple}{rgb}{0.627,0.126,0.941}

% PDF Informationen
\title{Beispieldokumentation zum Projektpraktikum}
\author{Hier bitte Autor eintragen}

% Seitengestaltung
\setlength\textheight{25.0cm}
\setlength\topmargin{-1.3cm}
\setlength\textwidth{1.1\textwidth}
% ohne Heftkante
\setlength\oddsidemargin{0pt}
\setlength\evensidemargin{0pt}
% mit Heftkante
%\setlength\oddsidemargin{+10pt}
%\setlength\evensidemargin{-10pt}
\setlength{\headheight}{13pt}

% Kopf- und Fußzeilen
\pagestyle{fancy}
\fancypagestyle{plain}{\thispagestyle{fancy}}

\fancyhead{}
%\fancyheadoffset[LE,RO]{0pt}
\fancyhead[LO,RE]{\leftmark} % aktuelle Section
\fancyhead[RO,LE]{\includegraphics[viewport=0 7.5 168 24,scale=0.5]{header}} % Logo here

\fancyfoot{}
%\fancyfootoffset[LE,RO]{0pt}
\fancyfoot[LO,RE]{} % aktuelle Chapter
\fancyfoot[LE]{\thepage\hspace{3em}Dokumentation zum IT-Projektpraktikum} %Seitenzahl links
\fancyfoot[RO]{Dokumentation zum IT-Projektpraktikum\hspace{3em}\thepage} %Seitenzahl recht

% Titel Linie
\newcommand{\bigrule}{\titlerule[0.5mm]}

% Titel Format
\titleformat{\chapter}[display]
{\bfseries\Huge}
{%
 \vskip-2em
 \titlerule
 \filright
 \Large\chaptertitlename\
 \Large\thechapter
}
{0mm}
{\filright}
[\bigrule]

% Definitionen für Listing
\lstset{ %
language=C++,                % choose the language of the code
numbers=left,                   % where to put the line-numbers
%numberstyle=\footnotesize,      % the size of the fonts that are used for the line-numbers
stepnumber=1,                   % the step between two line-numbers. If it's 1 each line will be numbered
numbersep=5pt,                  % how far the line-numbers are from the code
backgroundcolor=\color{white},  % choose the background color. You must add \usepackage{color}
showspaces=false,               % show spaces adding particular underscores
showstringspaces=false,         % underline spaces within strings
%showtabs=false,                 % show tabs within strings adding particular underscores
frame=single,                   % adds a frame around the code
tabsize=2,                      % sets default tabsize to 2 spaces
captionpos=t,                   % sets the caption-position to bottom
breaklines=true,                % sets automatic line breaking
xleftmargin=3.5pt,
xrightmargin=3.5pt,
breakatwhitespace=false,        % sets if automatic breaks should only happen at whitespace
extendedchars=true,captionpos=t , prebreak=\mbox{$\hookleftarrow$}, belowcaptionskip=0.5em,postbreak={},
basicstyle=\ttfamily,       % the size of the fonts that are used for the code
keywordstyle=\color{blue}\bfseries\sffamily,
commentstyle=\color{mygreen}\slshape,
stringstyle=\color{mypurple},
}

\setlength{\parindent}{0pt} % Texteinzug bei neuem Absatz

% Zähler für Ausgabe
\newcounter{ausgabe}[chapter]
\renewcommand\theausgabe{\thechapter.\arabic{ausgabe}}

% Programmausgabe, grau hinterlegen
\newcommand{\ausg}[2]{
	\stepcounter{ausgabe}

	\vspace{2mm}
	\begin{minipage}{\textwidth}
	  \colorbox{codegray}{
			\begin{minipage}{0.97\textwidth}
				\textbf{\texttt{#2}}
			\end{minipage}
		}
		\begin{center}
			Ausgabe \theausgabe: #1
		\end{center}
	\end{minipage}
}

% Schreibt 'Code::Blocks'
\newcommand{\cb}{\mbox{Code::Blocks}\xspace}

% Schreibt 'Visual Studio'
\newcommand{\vs}{\mbox{Visual Studio}\xspace}

% TODO - Command
\newcommand{\TODO}[1]{{\color{red}TODO!! #1}}

% Leerseite ohne Seitennummer, nächste Seite rechts
\newcommand{\blankpage}{
 \clearpage{\pagestyle{empty}\cleardoublepage}
}



\begin{document}
%----------------------------
\input{titelpage}
%----------------------------
\tableofcontents

\chapter{Einleitung}
Die praktisch orientierte Aufgabe im dritten Semester war das Projektpraktikum. Die Aufgabenstellen  lautetet, ein TivSeg, das einem Segway ähnelt, zu programmieren. Hierbei wurde man in zufälligen Dreiergruppen eingeteilt. 
\section{Arbeitsumfeld}
Als Arbeitsumfeld wählte man den webbasierten Hosting Dienst Github, um die unterschiedlichen Quellcodes zusammenzufügen. Vorteil hierbei ist, dass die Codes gleich gematcht werden und jeder auf dem neusten Stand des Projekts ist. An der History ist der gesamte Verlauf des Projekts gut zu verfolgen. Es wir genau aufgezeichnet wer wann welchen Quellcode hochgeladen hat und was verändert wurde.
\section{Zielbestimmung}
Laut Aufgabenstellung sollte bei dem Projektpraktikum gelernt werden, wie  komplexe C++ Codeabschnitte geschrieben werden und wie eine hardwarenahe Programmierung aussieht. Des Weiteren sollte das Arbeiten mit einer integrierten Entwicklungsumgebung geübt werden. Das Herz des TivSegs, mit welchem die Sensorik und Aktorik gesteurt wird, besteht aus dem EI-Mikrocontroller Board. Mit diesem hat man sich schon in den ersten beiden Semestern vertraut gemacht, da dieser die Grundlage der Workshops war.  Damit sollte auch das Testen einzelner Codeabschnitte auf dem Board geübt werden.\\
Da das Projektpraktikum in Gruppenarbeit gelöst wurde, sollte auch die Teamfähigkeit und die Zeitplanung in solch einem Projekt gefördert werden.
\section{Einsatz}
Das TivSeg soll in den Bereichen touristische Stadtführungen, Patrouillenfahrten bei
Polizeibehörden sowie die Erleichterung für Lehrpersonals auf dem Weg zu Lehrveranstaltungen eingesetzt werden. 
\section{Zeitplanung}
Beim ersten Treffen wurden die einzelnen Module auf die Gruppenmitglieder aufgeteilt. Marcel übernahm die Module ADC und ADC Sensor, Nico die Module PWM, Motor und GPIO und Selina den Timer sowie die Dokumentation. Das Testen der einzelnen Module auf dem EI-Board wurde von den jeweils Zuständigen übernommen. Der Gesamttest wurde mit Hilfe der Simulation zusammen durchgeführt. Für die Programmierung der einzelnen Module wurden 4 Wochen  eingeplant. Die Woche darauf wurden Probleme der einzelnen Gruppenmitglieder besprochen und mit Hilfe des Tutors besprochen. In dieser Woche wurden auch die Module den Einzeltests unterzogen. In Woche 6 wurde dann der erste Gesamttest gestartet und nach ein paar Anläufen funktionierte die Simulation. Abschließend wurde in Woche 7 die Dokumentation geschrieben und die einzelnen Module wurden von den jeweils Verantwortlichen nochmal den anderen Gruppenmitgliedern erklärt.

\chapter{Konzeption}
\section{Regelalgorithmus}
Der Regelalgorithmus wurde den Gruppen bereit gestellt, wodurch daran nichts mehr geändert werden musste.\\
Dieser Regelalgorithmus übernimmt die Aufgabe des gerade Ausfahrens, das Berechnen der Geschwindigkeit mittels übergebenen
Sensorwerten als auch die Regelung der Lenkung.
% \subsection{MATLAB/Simulink Model}
\section{Benötigte Module und ihre Funktion}
Die folgenden Module mussten programmiert werden:
\begin{itemize}
\item Timer:\\
Wie der Name schon sagt, hat der Timer die Aufgabe, intern bis zu einem bestimmten Wert hoch zuzählen. Dies ist nötig, damit die verschiedenen Module einen Bezugswert haben und alle Funktionen somit auf die gleiche Zeitskala zurückgreifen. \\
Bei dem Wavesalemode wurde als Maximalwert ein variabler RC-Wert gewählt, der mittels einer übergebenen Frequenz in der Funktion "prepareTimer" berechnet wird. Im gewählten Diagramm (siehe S.484 im Datenblatt des Mikrocontrollers), das den Wavesalemode darstellt, wurde auf der x-Achse der Timer und auf der y-Achse der Counter Value aufgetragen. Als Kurvenart wählte man die Sägezahnkurve, da somit besser die Zeit berechnet werden kann. 
\item GPIO Sensor\\
Der GPIO Sensor steuert die einzelnen Pins des Mikrocontroller Boards an und liest deren Werte aus.
\item ADC\\
\item ADC Sensor\\
\item PWM\\
Über das PWM Modul wird die Geschwindigkeit des TivSegs gesteuert. Um die Funktionsweise zu erklären, werden die Diagramme auf S. 520 im Datenblatt des Mikrocontrollers verwendet. Im Allgemeinen ist die Fläche unter der Kurve "Output Waveform PWMx" ein Maß für die Geschwindigkeit. Diese Kurve kann auf zwei Arten modelliert werden. Zum Einen kann der CDTY-Wert geändert werden, oder zum Anderen die Periodendauer. Hier wählte man eine feste Periode, die durch die Formel auf S. 518 im Datenblatt berechnet wurde.
\item Motor
In der Motorklasse werden die einzelnen Räder angesteuert, wodurch das Lenken realisiert werden kann. 

\end{itemize}


\section{Beschreibung der Schnittstellen}

\chapter{Realisierung}
\section{Hardware Abstraction Layer}
Zu Deutsch Hardwareabstraktionsschicht oder kurz HAL ist eine Schicht des Betriebssystems, die als Einzige auf die Hardware zugreifen kann. Die restliche Software kann nur über die HAL auf die Hardware zugreifen.
\subsection{Implementierung}
Die Beschreibung der einzelnen Funktionen in den jeweiligen Modulen sind im folgenden niedergeschrieben. Diese wurden mittels Doxygen erstellt.  
\subsection{Test der HAL}
Die beiden Module PWM und Timer konnte man auf dem EI-Board testen. Beim PWM wurde die Funktion getestet, indem die LEDs in unterschiedlichen Helligkeitsstufen leuchten sollen. Beim Timer wurde die erfolgreiche Initialisierung durch eine LED angezeigt und das Hochzählen durch eine blinkende LED realisiert.
Der Gesamttest wurde dann mittels der Simulator durchgeführt.
Bei den Tests wurden einige Fehler entdeckt. Fehler waren unter anderem das Falschschreiben einer Basisadresse, ... -> Nico, Marcel welche Fehler sind euch unterlaufen?
\subsection{Zusammenfügen der Module}
Wie schon im Abschnitt Arbeitsumfeld beschrieben, verwendeten wir zum Zusammenfügen der Module Github.

\chapter{Integration und Test}
\section{Integration}
\section{Abschlusstests}
Nach einigen Versuchen im Simulator funktionierten die Quellcodes in Woche 6.

\chapter{Zusammenfassung und Ausblick}
\section{Zusammenfassung}
Zusammenfassend kann man sagen, dass das TivSeg nun für den täglichen Gebrauch verwendet werden kann.\\ Nach einer Einarbeitungszeit und guter Zusammenarbeit zwischen den Teammitglieder konnte die Aufgabenstellung gelöst werden. Der Umgang mit dem Datenblatt wurde immer vertrauter und man lernte wie sich die Hexadezimal-Adressen der einzelnen Komponenten zusammensetzen. Der Hauptbestandteil der hardwarenahen Programmierung, das setzen von Bits, wurde kennengelernt, womit man nun einen ersten Einblick in diese Programmierung erhielt.\\
Das schöne an dem Projekt ist, dass man zum Abschluss die Früchte seiner Arbeit sehen konnte. So konnte man seine eigene Arbeit selbst in der Praxis ausprobieren, was bestimmt mit jeder Menge Spaß verbunden ist.    

\section{Ausblick}
Die Grundfunktion des TivSegs, die Fortbewegung, TivSeg funktioniert nun. Für die unterschiedlichen Einsatzgebiete könnten dies weitere Ausrüstmöglichkeiten sein:
\begin{itemize}
\item Touristenbranchen:\\
Bei Stadtführungen sind Fotos schöne Erinnerungen. Damit man nicht immer absteigen muss, wenn ein schönes Motiv festgehalten werden soll, könnte man beispielsweise eine GoPro (Actionkamera) anbringen und diese mit einem Fernauslöser, angebracht an den Haltegriffen, bestücken. So könnte schnell und ohne absteigen Schnappschüsse geschossen werden und kein Motiv geht mehr verloren.
\item Polizei: \\
Für Patrouillenfahrten sollte das TivSeg auch geländetauglich sein. Hierfür müssten Reifen mit tieferen Profilen bereitgestellt werden und eine Assistent zur Unterstützung der Gewichtsausgleichung entwickelt werden.
\item Unigelände:\\
Eines der wichtigsten Komponenten im Unialltag ist der Kaffee. Da wäre es doch schade, wenn der Kaffee noch schnell getrunken werden muss, damit man noch pünktlich mit dem TivSeg in der nächsten Vorlesung erscheint. Da wäre eine Kaffeehalterung doch ideal. Mit einem Sensor könnte die Füllhöhe bestimmt werden und somit berechnet werden, in welchem Winkel maximal das TivSeg gebeugt werden kann, damit der Kaffee nicht ausgeschüttet wird. 
\end{itemize}  
%----------------------------
\nocite{*}
\bibliography{literatur}
\bibliographystyle{alpha}
%----------------------------
\end{document}
